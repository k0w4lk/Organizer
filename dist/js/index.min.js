"use strict";const newTaskText=document.querySelector("#new-task-text"),newTaskAdd=document.querySelector("#new-task-add"),newTaskError=document.querySelector("#new-task-error"),counterTBD=document.querySelector("#counter-TBD"),counterDone=document.querySelector("#counter-done"),massButtonsTBD=document.querySelector("#mass-buttons-TBD"),massButtonsDone=document.querySelector("#mass-buttons-done"),chooseAllTBD=document.querySelector("#choose-all-TBD"),chooseAllDone=document.querySelector("#choose-all-done"),allToDone=document.querySelector("#all-to-done"),allToExecution=document.querySelector("#all-to-execution"),deleteAllTBD=document.querySelector("#delete-all-TBD"),deleteAllDone=document.querySelector("#delete-all-done"),listTBD=document.querySelector("#list-TBD"),listDone=document.querySelector("#list-done");let dataTBD,dataDone;function getTasksData(){dataTBD=JSON.parse(localStorage.getItem("dataTBD"))||[],dataDone=JSON.parse(localStorage.getItem("dataDone"))||[]}function saveTasksData(e){e?localStorage.setItem("dataTBD",JSON.stringify([...dataTBD,{text:e.taskText,id:e.taskID,isChecked:e.isChecked,toEdit:e.toEdit}])):(localStorage.setItem("dataTBD",JSON.stringify([...dataTBD])),localStorage.setItem("dataDone",JSON.stringify([...dataDone])))}function addNewTask(){const e=newTaskText.value;if(newTaskText.focus(),!e)return void(newTaskError.innerText="You have not entered a task name");const t=Math.random().toString(32).slice(3);newTaskText.value="",resetCheckboxesStatuses(),massButtonActivity(),saveTasksData({taskText:e,taskID:t,isChecked:!1,toEdit:!1}),renderTasks()}function createNewTaskTemplate(e,t){const a=document.createElement("li");a.dataset.id=e.id,a.classList.add("l-main-task__container");const s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=e.isChecked,s.classList.add("l-main-task__checkbox");const n=document.createElement("span");n.innerText=e.text,n.classList.add("l-main-task__text");const o=document.createElement("button");o.classList.add("l-main-task__edit-button"),o.dataset.edit="edit",a.append(s,n,o),t.append(a)}function renderTasks(){getTasksData(),listTBD.innerHTML="",listDone.innerHTML="",dataTBD.forEach(e=>createNewTaskTemplate(e,listTBD)),dataDone.forEach(e=>createNewTaskTemplate(e,listDone)),updateTasksCounter(counterTBD,listTBD),updateTasksCounter(counterDone,listDone),chooseAllDone.disabled=!1,chooseAllTBD.disabled=!1}function resetCheckboxesStatuses(){chooseAllTBD.checked=!1,chooseAllDone.checked=!1,document.querySelectorAll(".l-main-task__checkbox").forEach(e=>{e.checked=!1,e.nextSibling.classList.remove("l-main-task_checked")}),dataTBD.forEach(e=>{e.isChecked=!1,e.toEdit=!1}),dataDone.forEach(e=>{e.isChecked=!1,e.toEdit=!1}),saveTasksData()}function clearNewTaskErrorText(){newTaskError.innerText=""}function updateTasksCounter(e,t){e.innerText=t.children.length,massButtonsDisplay()}function chooseAllTasks(e,t,a){t.checked?e.forEach(e=>e.isChecked=!0):(e.forEach(e=>e.isChecked=!1),unlockCheckboxesDone()),saveTasksData(),renderTasks(),t.checked?("list-TBD"===a.id&&(chooseAllDone.disabled=!0,lockCheckboxesDone()),"list-done"===a.id&&(chooseAllTBD.disabled=!0,lockCheckboxesTBD())):("list-TBD"===a.id&&(chooseAllDone.disabled=!1,unlockCheckboxesDone()),"list-done"===a.id&&(chooseAllTBD.disabled=!1,unlockCheckboxesTBD())),massButtonActivity()}function moveTasksToDone(){dataTBD=dataTBD.filter(e=>!e.isChecked||(dataDone.push(e),!1)),saveTasksData(),resetCheckboxesStatuses(),renderTasks(),massButtonActivity()}function moveTasksToExecution(){dataDone=dataDone.filter(e=>!e.isChecked||(dataTBD.push(e),!1)),saveTasksData(),resetCheckboxesStatuses(),renderTasks()}function chooseTask(e,t,a){e.target.classList.contains("l-main-task__checkbox")&&(t.forEach(t=>{t.id===e.target.parentNode.dataset.id&&(e.target.checked?(t.isChecked=!0,e.target.nextSibling.classList.add("l-main-task_checked"),saveTasksData()):(t.isChecked=!1,e.target.nextSibling.classList.remove("l-main-task_checked"),saveTasksData()))}),t.filter(e=>e.isChecked).length?("list-TBD"===a.id&&(lockCheckboxesDone(),chooseAllDone.disabled=!0),"list-done"===a.id&&(lockCheckboxesTBD(),chooseAllTBD.disabled=!0)):("list-TBD"===a.id&&(unlockCheckboxesDone(),chooseAllDone.disabled=!1),"list-done"===a.id&&(unlockCheckboxesTBD(),chooseAllTBD.disabled=!1)),massButtonActivity())}function lockCheckboxesDone(){listDone.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!0)}function unlockCheckboxesDone(){listDone.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!1)}function lockCheckboxesTBD(){listTBD.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!0)}function unlockCheckboxesTBD(){listTBD.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!1)}function massButtonActivity(){let e=0,t=0;dataTBD.forEach(t=>{t.isChecked&&e++}),dataDone.forEach(e=>{e.isChecked&&t++}),e?(allToDone.disabled=!1,deleteAllTBD.disabled=!1):(allToDone.disabled=!0,deleteAllTBD.disabled=!0),t?(allToExecution.disabled=!1,deleteAllDone.disabled=!1):(allToExecution.disabled=!0,deleteAllDone.disabled=!0)}function massButtonsDisplay(){"0"===counterTBD.innerText?(massButtonsTBD.classList.add("l-main-tasks__mass-action-buttons_hidden"),massButtonsTBD.classList.remove("l-main-tasks__mass-action-buttons_active")):(massButtonsTBD.classList.add("l-main-tasks__mass-action-buttons_active"),massButtonsTBD.classList.remove("l-main-tasks__mass-action-buttons_hidden")),"0"===counterDone.innerText?(massButtonsDone.classList.add("l-main-tasks__mass-action-buttons_hidden"),massButtonsDone.classList.remove("l-main-tasks__mass-action-buttons_active")):(massButtonsDone.classList.add("l-main-tasks__mass-action-buttons_active"),massButtonsDone.classList.remove("l-main-tasks__mass-action-buttons_hidden"))}function editTaskTBD(e){if(e.target.classList.contains("l-main-task__edit-button")){if("edit"===e.target.dataset.edit){resetCheckboxesStatuses(),massButtonActivity(),e.target.classList.add("l-main-task__edit-button_save"),dataTBD.forEach(t=>{e.target.parentNode.dataset.id===t.id&&(t.toEdit=!0)}),saveTasksData(),lockEditButtons(dataTBD);let t=document.createElement("input");return t.style="width: 85%",t.setAttribute("maxlength","30"),t.value=e.target.previousSibling.innerText,e.target.previousSibling.replaceWith(t),t.focus(),e.target.dataset.edit="save",lockCheckboxesDone(),lockCheckboxesTBD(),chooseAllDone.disabled=!0,void(chooseAllTBD.disabled=!0)}if("save"===e.target.dataset.edit){let t=e.target.previousSibling.value,a=e.target.parentNode.dataset.id;dataTBD=t.length?dataTBD.map(e=>e.id===a?(e.text=t,e):e):dataTBD.filter(e=>e.id!==a),saveTasksData(),renderTasks()}}}function editTaskDone(e){if(e.target.classList.contains("l-main-task__edit-button")){if("edit"===e.target.dataset.edit){resetCheckboxesStatuses(),massButtonActivity(),e.target.classList.add("l-main-task__edit-button_save"),dataDone.forEach(t=>{e.target.parentNode.dataset.id===t.id&&(t.toEdit=!0)}),saveTasksData(),lockEditButtons(dataDone);let t=document.createElement("input");return t.style="width: 85%",t.setAttribute("maxlength","30"),t.value=e.target.previousSibling.innerText,e.target.previousSibling.replaceWith(t),t.focus(),e.target.dataset.edit="save",lockCheckboxesDone(),lockCheckboxesTBD(),chooseAllDone.disabled=!0,void(chooseAllTBD.disabled=!0)}if("save"===e.target.dataset.edit){let t=e.target.previousSibling.value,a=e.target.parentNode.dataset.id;dataDone=t.length?dataDone.map(e=>e.id===a?(e.text=t,e):e):dataDone.filter(e=>e.id!==a),saveTasksData(),renderTasks()}}}function lockEditButtons(e){let t=document.querySelectorAll(".l-main-task__edit-button");e.forEach(e=>{e.toEdit&&t.forEach(t=>{e.id!==t.parentNode.dataset.id&&(t.disabled=!0)})})}function deleteTasksTBD(){dataTBD=dataTBD.filter(e=>!e.isChecked),saveTasksData(),renderTasks(),resetCheckboxesStatuses(),massButtonActivity()}function deleteTasksDone(){dataDone=dataDone.filter(e=>!e.isChecked),saveTasksData(),renderTasks(),resetCheckboxesStatuses(),massButtonActivity()}newTaskAdd.addEventListener("click",()=>addNewTask(newTaskText,listTBD)),newTaskText.addEventListener("keyup",e=>{"Enter"===e.code&&addNewTask(newTaskText,listTBD)}),newTaskText.addEventListener("blur",clearNewTaskErrorText),chooseAllTBD.addEventListener("change",()=>chooseAllTasks(dataTBD,chooseAllTBD,listTBD)),chooseAllDone.addEventListener("change",()=>chooseAllTasks(dataDone,chooseAllDone,listDone)),allToDone.addEventListener("click",moveTasksToDone),allToExecution.addEventListener("click",moveTasksToExecution),listTBD.addEventListener("change",()=>chooseTask(event,dataTBD,listTBD)),listDone.addEventListener("change",()=>chooseTask(event,dataDone,listDone)),listTBD.addEventListener("click",()=>editTaskTBD(event)),listDone.addEventListener("click",()=>editTaskDone(event)),deleteAllTBD.addEventListener("click",deleteTasksTBD),deleteAllDone.addEventListener("click",deleteTasksDone),getTasksData(),resetCheckboxesStatuses(),renderTasks();const currentDate=document.querySelector("#current-date"),qodAuthor=document.querySelector("#qod-author"),qodText=document.querySelector("#qod-text"),QUOTE_URL="https://quotes.rest/qod";let days=["Sunday","Monday","Tuesday","Wednessday","Thursday","Friday","Saturday"];function getCurrentDate(){return new Date}function showCurrentDate(){let e=getCurrentDate();currentDate.innerText=`${e.toLocaleDateString()} (${days[e.getDay()]})`}async function getQoD(){let e=await fetch(QUOTE_URL),t=await e.json(),a=await t.contents.quotes[0].quote,s=await t.contents.quotes[0].author;qodAuthor.innerText=s+":",qodText.innerText=`"${a}"`}getQoD(),showCurrentDate(),setInterval(()=>{getQoD(),showCurrentDate()},6e4);const API_KEY="58b6f7c78582bffab3936dac99c31b25",IMG_URL="http://openweathermap.org/img/wn/10d@2x.png",DEFAULT_CITY_NAME="Verkhnedvinsk",weatherIcon=document.querySelector("#weather-icon"),weatherCity=document.querySelector("#weather-city"),weatherTemperature=document.querySelector("#weather-temperature"),feelsLikeText=document.querySelector("#feels-like"),changeCity=document.querySelector("#change-city"),changeCityButton=document.querySelector("#change-city-button"),weatherBlock=document.querySelector("#weather-block"),weatherPreload=document.querySelector("#weather-preload"),weatherLoad=document.querySelector("#weather-load");let savedCity=JSON.parse(localStorage.getItem("savedCity"))||{city:void 0},temperature,feelsLike,icon,src,city;function saveCity(e){savedCity.city=e,localStorage.setItem("savedCity",JSON.stringify(savedCity))}async function getWeatherData(e,t){try{let a=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=${e}&units=metric`);return await a.json()}catch(e){console.log(e)}}getWeatherData(API_KEY,localStorage.getItem("savedCity")?savedCity.city:DEFAULT_CITY_NAME).then(e=>{temperature=e.main.temp,feelsLike=e.main.feels_like,icon=e.weather[0].icon,city=e.name,src=`http://openweathermap.org/img/wn/${icon}@2x.png`,weatherCity.innerText=city+": ",feelsLikeText.innerHTML=`Feels like: ${Math.round(feelsLike)} &#730;C`,weatherTemperature.innerHTML=Math.round(temperature)+" &#730;C",weatherIcon.src=src,changeCity.innerHTML=city+" isn't your city?",changeCityButton.innerText="Change.",weatherPreload.classList.add("l-main-header__weather-preloader_hidden"),weatherLoad.classList.remove("l-main-header__weather-loaded_hidden")});const save=document.createElement("button");save.innerText="Save";const newCity=document.createElement("input");changeCityButton.addEventListener("click",()=>{weatherLoad.classList.add("l-main-header__weather-loaded_hidden"),weatherBlock.append(newCity,save),save.style="\n  margin-left: 4px;\n  ",newCity.focus(),newCity.placeholder="Enter your city"}),save.addEventListener("click",()=>{getWeatherData(API_KEY,newCity.value).then(e=>{try{temperature=e.main.temp,feelsLike=e.main.feels_like,icon=e.weather[0].icon,city=e.name,src=`http://openweathermap.org/img/wn/${icon}@2x.png`,weatherCity.innerText=city+": ",feelsLikeText.innerHTML=`Feels like: ${Math.round(feelsLike)} &#730;C`,weatherTemperature.innerHTML=Math.round(temperature)+" &#730;C",weatherIcon.src=src,changeCity.innerHTML=city+" isn't your city?",changeCityButton.innerText="Change.",weatherPreload.classList.add("l-main-header__weather-preloader_hidden"),weatherLoad.classList.remove("l-main-header__weather-loaded_hidden"),saveCity(newCity.value),newCity.remove(),save.remove()}catch{newCity.value="",newCity.placeholder="City not found",newCity.focus(),weatherBlock.append(errorText)}})});let one=document.querySelector("#one"),two=document.querySelector("#two"),three=document.querySelector("#three"),four=document.querySelector("#four"),five=document.querySelector("#five"),six=document.querySelector("#six"),seven=document.querySelector("#seven"),eight=document.querySelector("#eight"),nine=document.querySelector("#nine"),zero=document.querySelector("#zero"),plus=document.querySelector("#plus"),minus=document.querySelector("#minus"),mult=document.querySelector("#mult"),div=document.querySelector("#div"),equally=document.querySelector("#equally"),output=document.querySelector("#output"),clean=document.querySelector("#clean"),arr=[],res=void 0,isResOnScreen=!1,isResWithOperator=!1;function pressNumber(){arr.length<12&&(isResOnScreen&&!isResWithOperator?arr[0]=this.textContent:arr.push(this.textContent),output.innerHTML=arr.join(""),isResOnScreen=!1,isResWithOperator=!1)}function pressOperator(){null!=arr[0]&&arr.length<12&&("+"==arr[arr.length-1]||"-"==arr[arr.length-1]||"*"==arr[arr.length-1]||"÷"==arr[arr.length-1]?(arr[arr.length-1]=this.textContent,output.innerHTML=arr.join("")):(arr.push(this.textContent),output.innerHTML=arr.join("")),isResWithOperator=!0)}function expressionResult(){res=eval(arr.join("").replace("÷","/"));let resString=res.toString();null!=res&&(resString.length>12?output.innerHTML=res.toFixed(3):output.innerHTML=res),arr.length=1,arr[0]=res,isResOnScreen=!0}function cleanOutput(){arr=[],output.innerHTML=arr.join("")}one.addEventListener("click",pressNumber),two.addEventListener("click",pressNumber),three.addEventListener("click",pressNumber),four.addEventListener("click",pressNumber),five.addEventListener("click",pressNumber),six.addEventListener("click",pressNumber),seven.addEventListener("click",pressNumber),eight.addEventListener("click",pressNumber),nine.addEventListener("click",pressNumber),zero.addEventListener("click",pressNumber),plus.addEventListener("click",pressOperator),minus.addEventListener("click",pressOperator),mult.addEventListener("click",pressOperator),div.addEventListener("click",pressOperator),equally.addEventListener("click",expressionResult),clean.addEventListener("click",cleanOutput);