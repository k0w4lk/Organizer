"use strict";const newTaskText=document.querySelector("#new-task-text"),newTaskAdd=document.querySelector("#new-task-add"),newTaskError=document.querySelector("#new-task-error"),counterTBD=document.querySelector("#counter-TBD"),counterDone=document.querySelector("#counter-done"),massButtonsTBD=document.querySelector("#mass-buttons-TBD"),massButtonsDone=document.querySelector("#mass-buttons-done"),chooseAllTBD=document.querySelector("#choose-all-TBD"),chooseAllDone=document.querySelector("#choose-all-done"),allToDone=document.querySelector("#all-to-done"),allToExecution=document.querySelector("#all-to-execution"),deleteAllTBD=document.querySelector("#delete-all-TBD"),deleteAllDone=document.querySelector("#delete-all-done"),listTBD=document.querySelector("#list-TBD"),listDone=document.querySelector("#list-done");let dataTBD,dataDone;function getTasksData(){dataTBD=JSON.parse(localStorage.getItem("dataTBD"))||[],dataDone=JSON.parse(localStorage.getItem("dataDone"))||[]}function saveTasksData(e){e?localStorage.setItem("dataTBD",JSON.stringify([...dataTBD,{text:e.taskText,id:e.taskID,isChecked:e.isChecked,toEdit:e.toEdit,isDone:e.isDone}])):(localStorage.setItem("dataTBD",JSON.stringify([...dataTBD])),localStorage.setItem("dataDone",JSON.stringify([...dataDone])))}function addNewTask(){const e=newTaskText.value.trim();if(newTaskText.focus(),!e)return newTaskError.innerText="You have not entered a task name",void(newTaskText.value="");const t=Math.random().toString(32).slice(3);newTaskText.value="",resetCheckboxesStatuses(),massButtonActivity(),clearNewTaskErrorText(),saveTasksData({taskText:e,taskID:t,isChecked:!1,toEdit:!1,isDone:!1}),renderTasks()}function createNewTaskTemplate(e,t){const a=document.createElement("li");a.dataset.id=e.id,a.classList.add("l-main-task__container");const n=document.createElement("input");n.setAttribute("type","checkbox"),n.checked=e.isChecked,n.classList.add("l-main-task__checkbox");const s=document.createElement("span");s.innerText=e.text,s.classList.add("l-main-task__text"),e.isDone?s.classList.add("l-main-task__text_done"):s.classList.remove("l-main-task__text_done");const o=document.createElement("button");o.classList.add("l-main-task__edit-button"),o.dataset.edit="edit",a.append(n,s,o),t.append(a)}function renderTasks(){getTasksData(),listTBD.innerHTML="",listDone.innerHTML="",dataTBD.forEach(e=>createNewTaskTemplate(e,listTBD)),dataDone.forEach(e=>createNewTaskTemplate(e,listDone)),updateTasksCounter(counterTBD,listTBD),updateTasksCounter(counterDone,listDone),chooseAllDone.disabled=!1,chooseAllTBD.disabled=!1}function resetCheckboxesStatuses(){chooseAllTBD.checked=!1,chooseAllDone.checked=!1,document.querySelectorAll(".l-main-task__checkbox").forEach(e=>{e.checked=!1,e.nextSibling.classList.remove("l-main-task_checked")}),dataTBD.forEach(e=>{e.isChecked=!1,e.toEdit=!1}),dataDone.forEach(e=>{e.isChecked=!1,e.toEdit=!1}),saveTasksData()}function clearNewTaskErrorText(){newTaskError.innerText=""}function updateTasksCounter(e,t){e.innerText=t.children.length,massButtonsDisplay()}function chooseAllTasks(e,t,a){t.checked?e.forEach(e=>e.isChecked=!0):(e.forEach(e=>e.isChecked=!1),unlockCheckboxesDone()),saveTasksData(),renderTasks(),t.checked?("list-TBD"===a.id&&(chooseAllDone.disabled=!0,lockCheckboxesDone()),"list-done"===a.id&&(chooseAllTBD.disabled=!0,lockCheckboxesTBD())):("list-TBD"===a.id&&(chooseAllDone.disabled=!1,unlockCheckboxesDone()),"list-done"===a.id&&(chooseAllTBD.disabled=!1,unlockCheckboxesTBD())),massButtonActivity()}function moveTasksToDone(){dataTBD=dataTBD.filter(e=>!e.isChecked||(e.isDone=!0,dataDone.push(e),!1)),saveTasksData(),resetCheckboxesStatuses(),renderTasks(),massButtonActivity()}function moveTasksToExecution(){dataDone=dataDone.filter(e=>!e.isChecked||(e.isDone=!1,dataTBD.push(e),!1)),saveTasksData(),resetCheckboxesStatuses(),renderTasks()}function chooseTask(e,t,a){e.target.classList.contains("l-main-task__checkbox")&&(t.forEach(t=>{t.id===e.target.parentNode.dataset.id&&(e.target.checked?(t.isChecked=!0,e.target.nextSibling.classList.add("l-main-task_checked"),saveTasksData()):(t.isChecked=!1,e.target.nextSibling.classList.remove("l-main-task_checked"),saveTasksData()))}),t.filter(e=>e.isChecked).length?("list-TBD"===a.id&&(lockCheckboxesDone(),chooseAllDone.disabled=!0),"list-done"===a.id&&(lockCheckboxesTBD(),chooseAllTBD.disabled=!0)):("list-TBD"===a.id&&(unlockCheckboxesDone(),chooseAllDone.disabled=!1),"list-done"===a.id&&(unlockCheckboxesTBD(),chooseAllTBD.disabled=!1)),massButtonActivity())}function lockCheckboxesDone(){listDone.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!0)}function unlockCheckboxesDone(){listDone.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!1)}function lockCheckboxesTBD(){listTBD.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!0)}function unlockCheckboxesTBD(){listTBD.querySelectorAll(".l-main-task__checkbox").forEach(e=>e.disabled=!1)}function massButtonActivity(){let e=0,t=0;dataTBD.forEach(t=>{t.isChecked&&e++}),dataDone.forEach(e=>{e.isChecked&&t++}),e?(allToDone.disabled=!1,deleteAllTBD.disabled=!1):(allToDone.disabled=!0,deleteAllTBD.disabled=!0),t?(allToExecution.disabled=!1,deleteAllDone.disabled=!1):(allToExecution.disabled=!0,deleteAllDone.disabled=!0)}function massButtonsDisplay(){"0"===counterTBD.innerText?(massButtonsTBD.classList.add("l-main-tasks__mass-action-buttons_hidden"),massButtonsTBD.classList.remove("l-main-tasks__mass-action-buttons_active")):(massButtonsTBD.classList.add("l-main-tasks__mass-action-buttons_active"),massButtonsTBD.classList.remove("l-main-tasks__mass-action-buttons_hidden")),"0"===counterDone.innerText?(massButtonsDone.classList.add("l-main-tasks__mass-action-buttons_hidden"),massButtonsDone.classList.remove("l-main-tasks__mass-action-buttons_active")):(massButtonsDone.classList.add("l-main-tasks__mass-action-buttons_active"),massButtonsDone.classList.remove("l-main-tasks__mass-action-buttons_hidden"))}function addNewTaskStatus(e){newTaskText.disabled=e,newTaskAdd.disabled=e,e?newTaskAdd.classList.add("l-main-tasks-header__new-task-add-button_locked"):newTaskAdd.classList.remove("l-main-tasks-header__new-task-add-button_locked")}function editTaskTBD(e){if(e.target.classList.contains("l-main-task__edit-button")){if("edit"===e.target.dataset.edit){resetCheckboxesStatuses(),massButtonActivity(),e.target.classList.add("l-main-task__edit-button_save"),dataTBD.forEach(t=>{e.target.parentNode.dataset.id===t.id&&(t.toEdit=!0)}),saveTasksData(),lockEditButtons(dataTBD),addNewTaskStatus(!0);let t=document.createElement("input");return t.style="width: 85%",t.setAttribute("maxlength","100"),t.value=e.target.previousSibling.innerText,e.target.previousSibling.replaceWith(t),t.focus(),e.target.dataset.edit="save",lockCheckboxesDone(),lockCheckboxesTBD(),chooseAllDone.disabled=!0,void(chooseAllTBD.disabled=!0)}if("save"===e.target.dataset.edit){let t=e.target.previousSibling.value.trim(),a=e.target.parentNode.dataset.id;dataTBD=t.length?dataTBD.map(e=>e.id===a?(e.text=t,e):e):dataTBD.filter(e=>e.id!==a),saveTasksData(),addNewTaskStatus(!1),renderTasks()}}}function editTaskDone(e){if(e.target.classList.contains("l-main-task__edit-button")){if("edit"===e.target.dataset.edit){resetCheckboxesStatuses(),massButtonActivity(),e.target.classList.add("l-main-task__edit-button_save"),dataDone.forEach(t=>{e.target.parentNode.dataset.id===t.id&&(t.toEdit=!0)}),saveTasksData(),addNewTaskStatus(!0),lockEditButtons(dataDone);let t=document.createElement("input");return t.style="width: 85%",t.setAttribute("maxlength","100"),t.value=e.target.previousSibling.innerText,e.target.previousSibling.replaceWith(t),t.focus(),e.target.dataset.edit="save",lockCheckboxesDone(),lockCheckboxesTBD(),chooseAllDone.disabled=!0,void(chooseAllTBD.disabled=!0)}if("save"===e.target.dataset.edit){let t=e.target.previousSibling.value.trim(),a=e.target.parentNode.dataset.id;dataDone=t.length?dataDone.map(e=>e.id===a?(e.text=t,e):e):dataDone.filter(e=>e.id!==a),saveTasksData(),addNewTaskStatus(!1),renderTasks()}}}function lockEditButtons(e){let t=document.querySelectorAll(".l-main-task__edit-button");e.forEach(e=>{e.toEdit&&t.forEach(t=>{e.id!==t.parentNode.dataset.id&&(t.disabled=!0)})})}function deleteTasksTBD(){dataTBD=dataTBD.filter(e=>!e.isChecked),saveTasksData(),renderTasks(),resetCheckboxesStatuses(),massButtonActivity()}function deleteTasksDone(){dataDone=dataDone.filter(e=>!e.isChecked),saveTasksData(),renderTasks(),resetCheckboxesStatuses(),massButtonActivity()}newTaskAdd.addEventListener("click",()=>addNewTask(newTaskText,listTBD)),newTaskText.addEventListener("keypress",e=>{"Enter"===e.code&&(e.preventDefault(),addNewTask(newTaskText,listTBD))}),newTaskText.addEventListener("blur",clearNewTaskErrorText),newTaskText.addEventListener("keydown",()=>{100===newTaskText.value.length&&(newTaskError.innerText="The maximum number of characters is 100")}),newTaskText.addEventListener("input",()=>{100===newTaskText.value.length?newTaskError.innerText="The maximum number of characters is 100":clearNewTaskErrorText()}),chooseAllTBD.addEventListener("change",()=>chooseAllTasks(dataTBD,chooseAllTBD,listTBD)),chooseAllDone.addEventListener("change",()=>chooseAllTasks(dataDone,chooseAllDone,listDone)),allToDone.addEventListener("click",moveTasksToDone),allToExecution.addEventListener("click",moveTasksToExecution),listTBD.addEventListener("change",()=>chooseTask(event,dataTBD,listTBD)),listDone.addEventListener("change",()=>chooseTask(event,dataDone,listDone)),listTBD.addEventListener("click",()=>editTaskTBD(event)),listDone.addEventListener("click",()=>editTaskDone(event)),deleteAllTBD.addEventListener("click",deleteTasksTBD),deleteAllDone.addEventListener("click",deleteTasksDone),getTasksData(),resetCheckboxesStatuses(),renderTasks();const currentDate=document.querySelector("#current-date"),qodAuthor=document.querySelector("#qod-author"),qodText=document.querySelector("#qod-text"),QUOTE_URL="https://quotes.rest/qod";let days=["Sunday","Monday","Tuesday","Wednessday","Thursday","Friday","Saturday"];function getCurrentDate(){return new Date}function showCurrentDate(){let e=getCurrentDate();currentDate.innerText=`${e.toLocaleDateString()} (${days[e.getDay()]})`}async function getQoD(){let e=await fetch(QUOTE_URL),t=await e.json(),a=await t.contents.quotes[0].quote,n=await t.contents.quotes[0].author;qodAuthor.innerText=n+":",qodText.innerText=`"${a}"`}getQoD(),showCurrentDate(),setInterval(()=>{getQoD(),showCurrentDate()},6e4);const API_KEY="fc522175fa7782718e0d7c3b81e2f841",IMG_URL="http://openweathermap.org/img/wn/10d@2x.png",DEFAULT_CITY_NAME="Verkhnedvinsk",weatherIcon=document.querySelector("#weather-icon"),weatherCity=document.querySelector("#weather-city"),weatherTemperature=document.querySelector("#weather-temperature"),feelsLikeText=document.querySelector("#feels-like"),changeCity=document.querySelector("#change-city"),changeCityButton=document.querySelector("#change-city-button"),weatherBlock=document.querySelector("#weather-block"),weatherPreload=document.querySelector("#weather-preload"),weatherLoad=document.querySelector("#weather-load"),refreshWeather=document.querySelector("#weather-refresh"),savedCity=JSON.parse(localStorage.getItem("savedCity"))||{city:void 0};function saveCity(e){savedCity.city=e,localStorage.setItem("savedCity",JSON.stringify(savedCity))}async function getWeatherData(e,t){try{let a=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=${e}&units=metric`);return await a.json()}catch(e){console.log(e)}}let temperature,feelsLike,icon,src,city;function fillWeatherTemplate(e){temperature=e.main.temp,feelsLike=e.main.feels_like,icon=e.weather[0].icon,city=e.name,src=`http://openweathermap.org/img/wn/${icon}@2x.png`,weatherCity.innerText=city+": ",feelsLikeText.innerHTML=`Feels like: ${Math.round(feelsLike)} &#730;C`,weatherTemperature.innerHTML=Math.round(temperature)+" &#730;C",weatherIcon.src=src,changeCity.innerHTML=city+" isn't your city?",changeCityButton.innerText="Change.",weatherPreload.classList.add("l-main-header__weather-preloader_hidden"),weatherLoad.classList.remove("l-main-header__weather-loaded_hidden")}function renderWeather(){getWeatherData(API_KEY,localStorage.getItem("savedCity")?savedCity.city:"Verkhnedvinsk").then(e=>{fillWeatherTemplate(e)})}const save=document.createElement("button");save.innerText="Save";const newCity=document.createElement("input");function renderSavedCityWeather(){getWeatherData(API_KEY,newCity.value).then(e=>{try{fillWeatherTemplate(e),saveCity(newCity.value),newCity.remove(),save.remove()}catch{newCity.value="",newCity.placeholder="City not found",newCity.focus()}})}changeCityButton.addEventListener("click",()=>{weatherLoad.classList.add("l-main-header__weather-loaded_hidden"),weatherBlock.append(newCity,save),save.style="\n  margin-left: 4px;\n  ",newCity.focus(),newCity.placeholder="Enter your city"}),save.addEventListener("click",()=>{renderSavedCityWeather()}),newCity.addEventListener("keypress",e=>{"Enter"===e.code&&renderSavedCityWeather()}),refreshWeather.addEventListener("click",()=>{weatherPreload.classList.remove("l-main-header__weather-preloader_hidden"),weatherLoad.classList.add("l-main-header__weather-loaded_hidden"),renderWeather()}),renderWeather();const output=document.querySelector("#output"),clean=document.querySelector("#clean"),buttons=document.querySelector("#buttons");let firstOperand="",secondOperand="",operator=null,wasResult=!1;function setOperand(e,t){"0"===t.target.value&&"0"===output.textContent||("0"===firstOperand&&(firstOperand=""),"0"===secondOperand&&(secondOperand=""),wasResult&&(clearData(),wasResult=!1),e?(secondOperand.length<8&&(secondOperand+=t.target.value),output.innerHTML=secondOperand):(firstOperand.length<8&&(firstOperand+=t.target.value),output.innerHTML=firstOperand))}function clearData(){firstOperand="",secondOperand="",operator=null,output.innerHTML=""}function getResult(e,t,a){let n;switch(a){case"+":return n=+e+ +t,n;case"-":return n=+e-+t,n;case"*":return n=+e*+t,n;case"/":return n=+e/+t,n}}function setOperator(e){""!==secondOperand&&(firstOperand=getResult(firstOperand,secondOperand,operator),secondOperand="",output.innerHTML=(""+firstOperand).length>8?firstOperand.toExponential(2):firstOperand,operator=e.target.value),wasResult=!1,operator=e.target.value}function showResult(){let e=getResult(firstOperand,secondOperand,operator);output.innerHTML=(""+e).length>8?e.toExponential(2):e}buttons.addEventListener("click",e=>{"buttons"!==e.target.id&&(isFinite(+e.target.value)&&setOperand(operator,e),isNaN(+e.target.value)&&"="!==e.target.value&&""!==firstOperand&&setOperator(e),"="===e.target.value&&""!==firstOperand&&""!==secondOperand&&(showResult(),firstOperand=output.textContent,operator=null,secondOperand="",wasResult=!0))}),clean.addEventListener("click",()=>{clearData()});const prevMonthButton=document.querySelector("#prev-month"),nextMonthButton=document.querySelector("#next-month"),goToToday=document.querySelector("#go-to-today"),daysTemplate=document.querySelector("#curr-month"),calendarTemplate=document.querySelector("#calendar"),currentMonth=(new Date).getMonth(),currentYear=(new Date).getFullYear();let months=["January","February","March","April","May","June","July","August","September","October","November","December"],holidays=[{month:0,day:1},{month:0,day:7},{month:2,day:8},{month:4,day:1},{month:4,day:9},{month:6,day:3},{month:10,day:7},{month:11,day:25}];function currentMonthDays(e,t){return new Date(new Date(t,e+1).setDate(0)).getDate()}function showCurrentMonthDays(e,t){let a=document.createElement("div");a.classList.add("l-main__calendar-dates");let n=new Date(t,e).getDay();if(n>=2)for(let e=1;e<n;e++){let e=document.createElement("div");a.append(e)}if(0===n)for(let e=0;e<6;e++){let e=document.createElement("div");a.append(e)}e:for(let n=1;n<=currentMonthDays(e,t);n++){for(let s of holidays)if(e===s.month&&n===s.day){let s=document.createElement("div");s.classList.add("l-main__calendar-dates-item","l-main__calendar-dates-item_red"),e===currentMonth&&t===currentYear&&n===(new Date).getDate()&&s.classList.add("l-main__calendar-item_today"),s.innerText=n,a.append(s);continue e}if(e===currentMonth&&t===currentYear&&n===(new Date).getDate()){let e=document.createElement("div");e.classList.add("l-main__calendar-dates-item","l-main__calendar-dates-item_today"),e.innerText=n,a.append(e)}else{let e=document.createElement("div");e.classList.add("l-main__calendar-dates-item"),e.innerText=n,a.append(e)}}calendar.innerHTML="",calendar.append(a)}let cbMonth=currentMonth,cbYear=currentYear;function render(e,t){daysTemplate.innerHTML=`${months[e]} ${t}`,showCurrentMonthDays(e,t)}prevMonthButton.addEventListener("click",()=>{render(cbMonth?--cbMonth:(cbMonth=11,11),11===cbMonth?--cbYear:cbYear)}),nextMonthButton.addEventListener("click",()=>{let e=11!==cbMonth?cbYear:++cbYear;render(11!==cbMonth?++cbMonth:(cbMonth=0,0),e)}),goToToday.addEventListener("click",()=>{cbMonth=currentMonth,cbYear=currentYear,render(currentMonth,currentYear)}),render(currentMonth,currentYear);